angular.module("myApp").controller("productByCategoryController",["$scope","cartService","productService","categoryService","ngNotify","$http","$state","productCategories","$uibModal","ngDialog","productFilterPanel","$timeout","lastSeen",function(t,e,o,r,n,a,i,c,l,d,u,p,s){function f(){$.products=c.data,$.pages=new Array(c.count),$.productFilterPanel=u,$.lastSeenProducts=s,S()}function g(t){$.selected=t,o.getPage({page:t}).$promise.then(function(t){$.products=t.data,$.pages=new Array(t.count)},function(t){})}function m(t){o.get({id:t}).$promise.then(function(t){console.log(t),$.productInfo=t,console.log($.productInfo)},function(t){})}function h(){}function I(t){var e=P.indexOf(Math.abs(t.checked));-1==e&&t.checked>0?P.push(t.checked):P.splice(e,1),O&&p.cancel(O),O=p(function(){i.go("categories",{option:P.join(",")},{reload:!0}),O=null},500)}function S(){if(void 0!=i.params.option){var t=i.params.option.split(",");for(var e in t)-1==P.indexOf(t[e])&&P.push(t[e]);angular.forEach($.productFilterPanel,function(e){angular.forEach(e.optionValues,function(e){t.indexOf(e.id.toString())>-1&&(e.checked=e.id,$.breadcrumbItems.push({id:e.id,title:e.title}))})})}void 0!=i.params.pageSize&&($.pageSize=i.params.pageSize),void 0!=i.params.orderBy&&($.orderBy=i.params.orderBy)}function v(){i.go("categories",{pageSize:$.pageSize},{reload:!0})}function y(){i.go("categories",{orderBy:$.orderBy},{reload:!0})}function b(t){var e=P.indexOf(t+"");e>-1&&P.splice(e,1),i.go("categories",{option:P.join(",")},{reload:!0})}var $=this;$.selected=0,$.productInfo={title:"",fullDescription:"",price:"",images:[]},$.breadcrumbItems=[],$.params=[{option:{value:1}}];var O=null,P=[];$.getPage=g,$.init=f,$.displayProduct=m,$.getFilterPanel=h,$.filterProduct=I,$.changePageSize=v,$.changeOrder=y,$.removeFilter=b,f(),t.slickConfig={dots:!0,autoplay:!0,initialSlide:3,infinite:!0,arrows:!0,rtl:!0,autoplaySpeed:3e3,method:{},event:{}},$.open=function(t){d.open({template:"myModalContent.html",width:"60%",resolve:{productInfo:function(){return o.get({id:t}).$promise.then(function(t){return console.log(t.attributesMap[0]),t})}},controller:["$scope","$rootScope","productInfo","cartService",function(e,o,r,n){function a(){var t=0;for(var o in e.productInfo.attributesMap)t++;return t}e.ngDialog=d,e.notSelectedOption=!0,e.cart={cartItem:{cartItemId:null,productId:t,quantity:1,cartItemAttribute:[]}},e.productInfo=r,e.addToAttributes=function(t){-1==e.cart.cartItem.cartItemAttribute.indexOf(t)&&(e.cart.cartItem.cartItemAttribute.push(t),angular.forEach(selectedOptions,function(e){e.id==t&&(e.selected=!0)})),console.log(e.cart)},e.slickConfig={dots:!1,autoplay:!0,initialSlide:3,infinite:!0,arrows:!0,rtl:!0,autoplaySpeed:3e3,method:{},event:{}},e.addToCart=function(t){var r=a();0!=r&&(t.cartItem.cartItemAttribute.length<r?e.notSelectedOption=!1:e.notSelectedOption=!0),e.notSelectedOption&&n.create(e.cart).$promise.then(function(t){o.$broadcast("add-to-cart",{cartItem:e.cart.cartItem}),e.ngDialog.close()},function(t){console.log("The request failed: "+e.cart)})}}]})}}]);